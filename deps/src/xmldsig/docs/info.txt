Перловый модуль для создания и проверки подписи стандарта xmldsig как с помощью RSA алгоритма, так и с использованием алгоритма ГОСТ.

Записан в SVN gt_c в директорию xmldsig. Собирается на данный момент только на сервере rsdev64, поскольку требует нестандартной библиотеки xmlsec1.


Функция sign
Вход
template    XML документ, в котором есть шаблон Signature
sigpath     XPath выражение, выбирающее ровно один тег Signature
cert        путь к файлу с сертификатом
key         путь к файлу с закрытым ключом
pwd         кодовая фраза от закрытого ключа

Выход
result      0 - успех, не 0 - ошибка
xml         подписанный XML в случае успеха, иначе сообщение об ошибке

Функция verify
Вход
xml         подписанный XML
xsd         необязательный путь к файлу с XSD схемой документа, если указан, то будет пытаться проверить валидность документа
sigpath     XPath выражение, выбирающее ровно один тег Signature

Выход
result      0 - успех, не 0 - ошибка
errmsg      сообщение об ошибке в случае неуспеха


В файле test.pl есть пример вызова обоих функций для RSA ключей и для ГОСТ.
